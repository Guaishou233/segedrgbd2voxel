# 点云可视化工具使用说明

## 功能特点

增强的点云可视化工具，便于人工核对生成的点云数据质量，包括：

1. **多视角展示**：
   - RGB图像、深度图、语义分割图
   - 3D点云主视图
   - 三个2D投影视图（俯视图、侧视图、前视图）

2. **统计信息**：
   - 点云基本统计（点数、坐标范围）
   - 语义标签分布统计
   - 深度分布直方图
   - 点云密度热图

3. **语义标签可视化**：
   - 彩色语义分割图（红色=机器人手臂，灰色=其他）
   - 语义标签饼图
   - 点云中语义颜色统计

## 使用方法

### 基本使用

```bash
# 可视化第一个样本
python visualize_pointcloud.py

# 可视化指定样本
python visualize_pointcloud.py --sample task_0001_user_0016_scene_0001_cfg_0003_036422060909_frame_000000

# 列出所有可用样本
python visualize_pointcloud.py --list
```

### 指定输出目录

```bash
# 保存可视化结果到指定目录
python visualize_pointcloud.py --sample task_0001_user_0016_scene_0001_cfg_0003_036422060909_frame_000000 --output_dir ./visualizations
```

### 使用Open3D交互式可视化

```bash
# 使用open3d进行交互式3D可视化（需要GUI环境）
python visualize_pointcloud.py --open3d
```

## 可视化内容说明

### 第一行：原始数据
- **RGB图像**：原始彩色图像
- **深度图**：深度信息（彩色编码）
- **语义分割图**：语义标签可视化（红色=机器人手臂，灰色=其他）
- **统计信息面板**：点云和语义标签的详细统计

### 第二行：3D点云视图
- **3D主视图**：完整的3D点云，使用语义颜色编码
- **俯视图（XY）**：从上方看点云
- **侧视图（XZ）**：从侧面看点云
- **前视图（YZ）**：从前方看点云

### 第三行：分析图表
- **语义标签分布饼图**：各语义类别的点数比例
- **深度分布直方图**：点云深度值的分布
- **点云密度热图**：XY平面的点云密度分布

## 核对要点

使用此工具进行人工核对应关注：

1. **语义标签正确性**：
   - 检查点云中的红色点是否对应机器人手臂区域
   - 检查语义分割图与点云颜色是否一致

2. **点云完整性**：
   - 检查点云是否包含足够的点
   - 检查是否有明显的空洞或缺失区域

3. **深度合理性**：
   - 检查深度值是否在合理范围内（0.3-0.8米）
   - 检查深度分布是否正常

4. **坐标一致性**：
   - 检查点云坐标范围是否合理
   - 检查不同视角的点云是否一致

## 参数说明

- `--dataset_dir`: 数据集目录（默认: `data/pointed_dataset`）
- `--sample`: 要可视化的样本名称（不含扩展名）
- `--list`: 列出所有可用样本
- `--open3d`: 使用open3d进行交互式3D可视化
- `--output_dir`: 输出目录（用于保存可视化图像）

## 注意事项

1. 如果没有GUI环境（无DISPLAY），图像会自动保存到文件
2. 点云如果点数过多（>100,000），会自动下采样以提高显示性能
3. 支持ASCII和二进制PLY格式（二进制格式需要open3d）

